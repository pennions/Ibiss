!function(){"use strict";function a(){const e=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),t=e.split("-")[0];return window._flightkitUUIDStore||(window._flightkitUUIDStore=[]),window._flightkitUUIDStore.some(e=>e===t)?a():(window._flightkitUUIDStore.push(t),t)}class e extends HTMLElement{_renderTimer;_id;_events=[];_observedAttributes=[];_customEvents=["@edit","@cancel","@save","@delete"];_topLevelClasses=[];constructor(){super(),this.id=this.id||"ft-"+a();var t=Object.keys(this.classList).length;if(t){for(let e=0;e<t;e++)this._topLevelClasses.push(this.classList[0]),this.classList.remove(this.classList[0]);this.removeAttribute("class")}}connectedCallback(){this.render()}disconnectedCallback(){this.removeEvents()}render(n){this._renderTimer=setTimeout(()=>{clearTimeout(this._renderTimer),this.beforeRender(),this.innerHTML="",this.append(n);var e=this._getAllEventAttributes();if(e){var t="#"+this.id;for(const s of e){var r="@"+s;!this._customEvents.includes(r)?this.addEvent(t,s,this.getAttribute(r)):this.addEvent(t,"click",this.getAttribute(r))}}this.afterRender()},10)}_getAllEventAttributes(){var e=this.attributes;const t=Array.from(e).filter(e=>e.name.startsWith("@"));return t.map(e=>e.name.slice(1))}_isFlightkitElement(e){return e.toUpperCase().includes("FT-")}_returnEventWithTopLevelElement(e){var{timeStamp:t,type:r,view:s,x:n,y:i}=e;let o=e.target;for(;!this._isFlightkitElement(o.tagName)&&(o=o.parentNode,!this._isFlightkitElement(o.tagName)););return{target:o,timeStamp:t,type:r,view:s,x:n,y:i}}addEvent(e,t,r){this._events.push({selector:e,eventType:t,callback:r})}_innerEventHander(r){let e,t,s=r.target;if(this._returnEventWithTopLevelElement)return e=this._returnEventWithTopLevelElement(r),t=e.target.getAttribute("@"+e.type),r.preventDefault(),r.stopPropagation(),this[t](e);{let e=r.target,t=e.dataset.action;for(;!e.tagName.toUpperCase().includes("FT-")&&(e=e.parentNode,void 0===t&&(t=e.dataset.action,t&&(s=e)),!e.tagName.toUpperCase().includes("FT-")););return e[t]({target:s},e)}}_outerEventHandler(e){const t=this._returnEventWithTopLevelElement(e),r=t.target.getAttribute("@"+t.type);let s=void 0;for(const n of r.split("."))s=(s||window)[n];return e.preventDefault(),e.stopPropagation(),s(t)}_addEvents(){if(this.isConnected)for(const t of this._events){let e=document.querySelector(t.selector);this[t.callback]?e.addEventListener(t.eventType,this._innerEventHander):e.addEventListener(t.eventType,this._outerEventHandler)}}_removeEvents(){for(const r of this._events){let e=document.querySelector(r.selector);var t=this[r.callback];this._currentCallback=r.callback,t?e.removeEventListener(r.eventType,this._innerEventHander):e.removeEventListener(r.eventType,this._outerEventHandler)}this._events=[]}beforeRender(){this._removeEvents()}afterRender(){this._addEvents()}}var c,l,y,t;(t=c=c||{}).Date="date",t.String="string",t.Float="float",t.Number="number",t.Array="array",t.Object="object",t.Bool="bool",t.Currency="currency",t.Undefined="undefined",t.Null="null";const u={date:/^(\d{1,4}-\d{1,4}-\d{1,4}(T)?)/gim,currency:/^[$|€]\s?[0-9]*(\.|,)?\d*(\.|,)?\d*/gim,float:/\d+[,|.]\d+[,|.]?\d*/gim,currencySign:/\$|€/gim,array:/^\s?[[].[^,]+[\]],?/gi,precision:/[-+$€,.]/gm,string:/[a-zA-Z]/gim},h=e=>{return null===e||"null"===e?c.Null:e||0===e||!1===e?null===new RegExp(u.date).exec(e)||isNaN(Date.parse(e))?new RegExp(u.currency).exec(e)?c.Currency:!new RegExp(u.string).exec(e)&&new RegExp(u.float).exec(e.toString())?c.Float:isNaN(e)&&0!==e?Array.isArray(e)?c.Array:"object"==typeof e?c.Object:c.String:c.Number:c.Date:c.Undefined},d=(t,e)=>{const r={value:void 0,type:e=e||h(t),currencySign:""};switch(r.type){case c.String:r.value=t.toString();break;case c.Float:case c.Currency:var s=(t=t.toString()).match(new RegExp(/(,)/gim)),n=t.match(new RegExp(/(\.)/gim));if(s)for(let e=1;e<=s.length;e++)t=e!==s.length||n?t.replace(",",""):t.replace(",",".");if(r.type===c.Currency){const o=new RegExp(u.currencySign);var i=o.exec(t);r.currencySign=null!==i?i[0]:"",t=t.replace(o,"")}r.value=parseFloat(t).toPrecision(12);break;case c.Number:r.value=Number(t);break;case c.Date:r.value=Date.parse(t);break;case c.Array:t.length?"object"==typeof t[0]?r.value=t.map(e=>JSON.stringify(e)).join(", "):r.value=t.join(", "):r.value="";break;case c.Object:r.value=t;break;case c.Undefined:r.value="";break;case c.Null:r.value=null}return r};function m(e,t){var r;let s;for(r of e.split("."))r=r.trim(),s?"object"!=typeof s||Array.isArray(s)||(s=s[r]):s=t[r];return s}const p=(e,t)=>t<e,f=(e,t)=>e<t,g=(e,t)=>t<=e,b=(e,t)=>e<=t,w=(e,t,r)=>r?e.toLowerCase()==t.toLowerCase():e==t,_=(e,t)=>e===t,E=(e,t)=>e!=t,A=(e,t)=>e!==t,k=(e,t)=>null!=t&&"string"==typeof e&&0<=e.toLowerCase().indexOf(t.toString().toLowerCase()),C=(e,t)=>null!=t&&0<=e.toString().toLowerCase().indexOf(t.toString().toLowerCase()),L=(e,t)=>null!=t&&"string"==typeof e&&e.toLowerCase().indexOf(t.toString().toLowerCase())<0;function r(r,s){if(0===s.length)return r;{var n=r;const o=[],a=[];let e=[];for(const c of s)c.type&&c.type!==l.And?(e.length&&a.push(e),e=[c]):e.push(c);a.push(e);let t=[];for(const e of a)t=t.concat(N(n,e));t=[...new Set(t)];var i=n.length;for(let e=0;e<i;e++)t.includes(e)&&o.push(n[e]);return o}}(t=l=l||{}).And="and",t.Or="or";const N=function(e,t){const r=[];if(!e)return r;for(var[s,n]of e.entries()){let e=!0;for(const a of t){var i=m(a.propertyName,n),i=d(i).value,o=d(a.value).value;const c=function(e){switch(e.toLowerCase()){case">":return p;case"<":return f;case">=":return g;case"<=":return b;case"is":case"==":return w;case"!is":case"!=":return E;case"===":return _;case"!==":return A;case"like":case"~":case"contains":return k;case"!contains":case"!like":case"!~":return L;default:return C}}(a.operator);if(!c(i,o,a.ignoreCase)){e=!1;break}}e&&r.push(s)}return r};function s(e,t){if(!t||0===t.length)return e;if(1<t.length){var n=e;var i=t;let r=[],s=[];return i.forEach(e=>{if(0===r.length)r=r.concat(o(n,e));else{for(const t of r)s=s.concat(o(t,e));r=s,s=[]}}),r}return o(e,t[0])}function o(e,t){const r=[],s=[];do{if(!e||0===e.length)break;var n=e.shift();if(!n)break;const o=n[t];var i=s.indexOf(o.toString());0<=i?r[i].push(n):(s.push(o.toString()),void 0!==r[s.length-1]?r[s.length-1].push(n):r.push([n]))}while(0<e.length);return r}function n(e,t){if(!t||0===t.length)return e;const r=Object.assign([],e);if(Array.isArray(r[0])){e=r;var s=t;const n=[];for(const i of e)n.push(i.sort(v(s)));n}else r.sort(v(t));return r}(t=y=y||{}).ascending="asc",t.descending="desc";function v(f,g=0){return function(e,u){var{propertyName:t,direction:r}=f[g];let s=e[t]||"",n=u[t]||"";const h=/^(\d{1,4}-\d{1,4}-\d{1,4}(T)?)/gim;var t=s instanceof Date&&n instanceof Date||h.test(s)&&h.test(n),d=(t&&(s=s instanceof Date?s.valueOf():new Date(Date.parse(s)),n=n instanceof Date?n.valueOf():new Date(Date.parse(n))),!isNaN(s)&&!isNaN(n)),i=(d&&(s=parseFloat(s).toPrecision(12),n=parseFloat(n).toPrecision(12)),!("true"!==s&&"false"!==s||"true"!==n&&"false"!==n));i&&(s="true"===s,n="true"===n);let o,a,c=(a=r===y.descending?(o=n,s):(o=s,n),0);if(i||t||d)c=o-a;else{o=o.toString().trim().toLowerCase(),a=a.toString().trim().toLowerCase();const l=/\d/gim;r=l.test(s)&&l.test(n);c=r?o.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"}):o.localeCompare(a)}i=g+1;if(0===c&&i<f.length){const p=v(f,i);return p(e,u)}return c}}const i=(e,t)=>{if(t){var r=e;const s={};for(const n of t){let e=r.map(e=>e[n].toString());const i=e.map(e=>h(e));i.some(e=>e===c.Float)?(e=e.map(e=>parseFloat(e)),s[n]=parseFloat(e.reduce((e,t)=>e+t).toFixed(2))):(e=e.map(e=>parseInt(e)),s[n]=e.reduce((e,t)=>e+t))}return s}return{}};class S{model;sortDetails=[];filterDetails=[];selection=[];groupByProperties=[];distinctProperties=[];concatenationToken=", ";constructor(e){this.model=JSON.parse(JSON.stringify(e))}sort(e){return this.sortDetails=e,this}orderBy(e,t){return this.sortDetails.push({propertyName:e,direction:t}),this}thenOrderBy(e,t){return this.orderBy(e,t)}filter(e){return Array.isArray(e)?this.filterDetails=e:this.filterDetails.push(e),this}where(e,t,r,s,n){return this.filterDetails.push({propertyName:e,operator:t,value:r,type:s,ignoreCase:n}),this}andWhere(e,t,r,s){return this.where(e,t,r,l.And,s),this}orWhere(e,t,r,s){return this.where(e,t,r,l.Or,s),this}group(e){return this.groupByProperties=e,this}groupBy(e){return this.groupByProperties.push(e),this}thenGroupBy(e){return this.groupByProperties.push(e),this}select(e){return Array.isArray(e)?this.selection=e:"*"!==e&&(this.selection=[e]),this}distinct(e,t){return t&&(this.concatenationToken=t),Array.isArray(e)?this.distinctProperties=e:e&&(this.distinctProperties=[e]),this}execute(){return s(function(t,r){if(0===r.length)return t;{var s=r;let e=[];for(const n of t){const i={};for(const o of s)i[o]=n[o];e.push(i)}return e}}(function(r,s,u){if(!s||!s.length)return r;const n=[],h=[];for(const f of r){const o={};let t="";for(const e of s){var d=m(e,f);o[e]=d,t+=d}if(!h.includes(t)){let e=r;for(const a of Object.keys(o))e=e.filter(e=>e[a]===o[a]);h.push(t),n.push(e)}}const t=[];for(const g of n){let e={};for(const c of g){var i,p=Object.keys(e);if(p.length)for(const l of p)s.includes(l)||(i=e[l],Array.isArray(i)?(i=c[l],Array.isArray(i)?e[l]=[...new Set(...e[l].concat(c[l]))]:e[l].includes(c[l])||e[l].push(c[l])):isNaN(e[l])&&isNaN(c[l])?e[l]!==c[l]&&(e[l]=[e[l],c[l]]):e[l]=e[l]+c[l]);else e=c}t.push(e)}return t.forEach(e=>{for(const t in e)Array.isArray(e[t])&&(e[t]=e[t].join(u))}),t}(n(r(JSON.parse(JSON.stringify(this.model)),this.filterDetails),this.sortDetails),this.distinctProperties,this.concatenationToken),this.selection),this.groupByProperties)}sum(e,t){e=Array.isArray(e)?e:[e];return i(t||this.model,e)}}customElements.define("ft-button",class extends e{constructor(){super();const e=document.createElement("button");this._topLevelClasses.length&&e.classList.add(...this._topLevelClasses),e.innerHTML=this.innerHTML,this.render(e)}}),customElements.define("ft-table",class extends e{_contents=[];_orderBy=[];properties=new Set;_columnOrder=[];_filter="";uniqueEntriesByProperties={};propertyLabelDictionary={};static get observedAttributes(){return["contents","columns","sort","direction","filter"]}get columnOrder(){return this._columnOrder.length?this._columnOrder:this.properties}set columnOrder(e){let t;"string"==typeof e&&(t=e.split(",")),t=e,this._columnOrder=t,this.render()}get contents(){return this._contents}set contents(e){this.analyzeData(e),this._contents=new S(e),this.render()}get orderBy(){return this._orderBy}set orderBy(e){this._orderBy=e,this.render()}get filter(){return this._filter}set filter(e){this._filter=e.toString(),this.render()}constructor(){super(),this.setContents(this.getAttribute("contents")),this.setColumnOrder(this.getAttribute("columns")),this.filter=this.getAttribute("filter");var e=this.getAttribute("order"),t=this.getAttribute("direction");e&&this._orderBy.push({propertyName:e,direction:t}),this._innerHTML=`<table class="${this._topLevelClasses.join(" ")}">${this.innerHTML}</table>`}setColumnOrder(e){this._columnOrder=e?Array.isArray(e)?e:e.split(","):[]}sortData(e,t){const r=e.target.dataset.column;r&&(-1<(e=t._orderBy.findIndex(e=>e.propertyName===r))?"asc"===t._orderBy[e].direction?t._orderBy[e].direction="desc":t._orderBy.splice(e,1):t._orderBy.push({propertyName:r,direction:"asc"}),this.render())}analyzeData(t){var r=t.length;for(let e=0;e<r;e++)for(const s of Object.keys(t[e]))this.properties.add(s),this.uniqueEntriesByProperties[s]||(this.uniqueEntriesByProperties[s]=new Set),this.uniqueEntriesByProperties[s].add(t[e][s])}setContents(e){var t=e||this.contents;try{switch(typeof t){case"string":this.contents=JSON.parse(t)||[];case"object":Array.isArray(t)?this.contents=t:this.contents=[t]}}catch(e){console.log(e)}}attributeChangedCallback(e,t,r){switch(e){case"contents":this.setContents(r);break;case"sort":this.orderBy=[{propertyName:r,direction:this.getAttribute("direction")}];break;case"filter":this.filter=r||"";break;case"columns":this.setColumnOrder(r),this.render();break;case"direction":this.orderBy=[{propertyName:this.getAttribute("order"),direction:r}]}}convertJsonKeyToTitle(e){if("string"!=typeof e&&(e=e.toString()),this.propertyLabelDictionary[e])return this.propertyLabelDictionary[e];const t=e.replace(/([A-Z_])/g,e=>"_"===e?" ":" "+e.toLowerCase());var r=t.charAt(0).toUpperCase()+t.slice(1);return this.propertyLabelDictionary[e]=r}createRow(e){const t=document.createElement("tr");for(const r of this.columnOrder){const s=document.createElement("td");s.innerText=e[r],t.append(s)}return t}createBody(e){const t=document.createElement("tbody");for(const s of e){var r=this.createRow(s,null);t.append(r)}return t}createHead(){const e=document.createElement("thead"),t=document.createElement("tr");t.classList.add("cursor-pointer");for(const s of this.columnOrder){var r="ft-"+a();const n=document.createElement("th"),i=(n.id=r,n.dataset.column=s,n.dataset.action="sortData",document.createElement("span"));i.innerText=this.convertJsonKeyToTitle(s),n.append(i),this.addEvent("#"+r,"click","sortData");r=this.orderBy.find(e=>e.propertyName===s);if(r){const o=document.createElement("span");o.innerHTML="asc"===r.direction?'<svg xmlns="http://www.w3.org/2000/svg" style="position: relative; top: 3px; left: 2px;" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-narrow-wide"><path d="m3 8 4-4 4 4"/><path d="M7 4v16"/><path d="M11 12h4"/><path d="M11 16h7"/><path d="M11 20h10"/></svg>':'<svg xmlns="http://www.w3.org/2000/svg" style="position: relative; top: 3px; left: 2px;" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-wide-narrow"><path d="m3 16 4 4 4-4"/><path d="M7 20V4"/><path d="M11 4h10"/><path d="M11 8h7"/><path d="M11 12h4"/></svg>',n.append(o)}t.append(n)}return e.append(t),e}render(){if(this.contents&&this.contents.model){this.beforeRender();const r=document.createElement("table");if(this._topLevelClasses.length&&r.classList.add(...this._topLevelClasses),this.orderBy.length?this.contents.sort(this.orderBy):this.contents.sort([]),this.filter.length){const s=[];for(const n of this.columnOrder)s.push({propertyName:n,value:this.filter,operator:"like",type:"or",ignoreCase:!0});this.contents.filter(s)}else this.contents.filter([]);var e=this.contents.execute(),t=this.createHead(),t=(r.append(t),this.createBody(e));r.append(t),this.innerHTML="",this.append(r),this.afterRender()}}})}();