!function(){"use strict";function i(e){return e.toUpperCase().includes("FLK-")}function o(e){var{timeStamp:t,type:r,x:n,y:s}=e;let o=e.target;for(;!i(o.tagName)&&(o=o.parentNode,!i(o.tagName)););return{target:o,timeStamp:t,type:r,x:n,y:s}}function a(){const e=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),t=e.split("-")[0];return window.$flightkitUUIDStore||(window.$flightkitUUIDStore=[]),window.$flightkitUUIDStore.some(e=>e===t)?a():(window.$flightkitUUIDStore.push(t),t)}const c={renderTimeout:null,_topLevelClasses:[],_events:[],render(t){if(!t.component)throw new Error("Component is not assigned! Can't render");t.id=t.id||"flk-"+a();var e=this._getAllEventAttributes(t);if(e){var r="#"+t.id;for(const o of e){var n="@"+o;this.addEvent(r,"click",t.getAttribute(n))}}var s=Object.keys(t.classList).length;if(s){for(let e=0;e<s;e++)this._topLevelClasses.push(t.classList[0]),t.classList.remove(t.classList[0]);t.removeAttribute("class")}this._topLevelClasses.length&&t.component.classList.add(...this._topLevelClasses),clearTimeout(this._renderTimer),this.renderTimeout=setTimeout(()=>{clearTimeout(this._renderTimer),this._assignToDom(t,t.component)},10)},addEvent(e,t,r){this._events.push({selector:e,eventType:t,callback:r})},_getExternalCallback(e){let t=void 0;for(const r of e.split("."))t=(t||window)[r];return t},_getAllEventAttributes(e){e=e.attributes;const t=Array.from(e).filter(e=>e.name.startsWith("@"));return t.map(e=>e.name.slice(1))},_isFlightkitElement(e){return e.toUpperCase().includes("FLK-")},_outerEventHandler(e){const t=o(e),r=t.target.getAttribute("@"+t.type);let n=void 0;for(const s of r.split("."))n=(n||window)[s];return e.preventDefault(),e.stopPropagation(),n(t)},_addEvents(e){if(e.isConnected)for(const t of this._events){let e=document.querySelector(t.selector);e&&("function"==typeof t.callback?(e.removeEventListener(t.eventType,t.callback),e.addEventListener(t.eventType,t.callback)):(e.removeEventListener(t.eventType,this._outerEventHandler),e.addEventListener(t.eventType,this._outerEventHandler)))}},removeEvents(){for(const t of this._events){let e=document.querySelector(t.selector);e&&("function"==typeof t.callback?e.removeEventListener(t.eventType,t.callback):e.removeEventListener(t.eventType,this._outerEventHandler))}this._events=[]},_assignToDom(e,t){e.innerHTML="",e.append(t),this._addEvents(e)}};class t extends HTMLElement{constructor(){super(),c.addEvent("#megafoo","click",this.test2)}test2(){alert("inner!")}connectedCallback(){const e=document.createElement("button");e.innerHTML=this.innerHTML,e.id="megafoo",this.component=e,c.render(this)}disconnectedCallback(){c.removeEvents(this)}}var l,u,g,e;(e=l=l||{}).Date="date",e.String="string",e.Float="float",e.Number="number",e.Array="array",e.Object="object",e.Bool="bool",e.Currency="currency",e.Undefined="undefined",e.Null="null";const d={date:/^(\d{1,4}-\d{1,4}-\d{1,4}(T)?)/gim,currency:/^[$|€]\s?[0-9]*(\.|,)?\d*(\.|,)?\d*/gim,float:/\d+[,|.]\d+[,|.]?\d*/gim,currencySign:/\$|€/gim,array:/^\s?[[].[^,]+[\]],?/gi,precision:/[-+$€,.]/gm,string:/[a-zA-Z]/gim},p=e=>{return null===e||"null"===e?l.Null:e||0===e||!1===e?null===new RegExp(d.date).exec(e)||isNaN(Date.parse(e))?new RegExp(d.currency).exec(e)?l.Currency:!new RegExp(d.string).exec(e)&&new RegExp(d.float).exec(e.toString())?l.Float:isNaN(e)&&0!==e?Array.isArray(e)?l.Array:"object"==typeof e?l.Object:l.String:l.Number:l.Date:l.Undefined},f=(t,e)=>{const r={value:void 0,type:e=e||p(t),currencySign:""};switch(r.type){case l.String:r.value=t.toString();break;case l.Float:case l.Currency:var n=(t=t.toString()).match(new RegExp(/(,)/gim)),s=t.match(new RegExp(/(\.)/gim));if(n)for(let e=1;e<=n.length;e++)t=e!==n.length||s?t.replace(",",""):t.replace(",",".");if(r.type===l.Currency){const i=new RegExp(d.currencySign);var o=i.exec(t);r.currencySign=null!==o?o[0]:"",t=t.replace(i,"")}r.value=parseFloat(t).toPrecision(12);break;case l.Number:r.value=Number(t);break;case l.Date:r.value=Date.parse(t);break;case l.Array:t.length?"object"==typeof t[0]?r.value=t.map(e=>JSON.stringify(e)).join(", "):r.value=t.join(", "):r.value="";break;case l.Object:r.value=t;break;case l.Undefined:r.value="";break;case l.Null:r.value=null}return r};function v(e,t){var r;let n;for(r of e.split("."))r=r.trim(),n?"object"!=typeof n||Array.isArray(n)||(n=n[r]):n=t[r];return n}const y=(e,t)=>t<e,w=(e,t)=>e<t,b=(e,t)=>t<=e,k=(e,t)=>e<=t,E=(e,t,r)=>r?e.toLowerCase()==t.toLowerCase():e==t,A=(e,t)=>e===t,C=(e,t)=>e!=t,_=(e,t)=>e!==t,S=(e,t)=>null!=t&&"string"==typeof e&&0<=e.toLowerCase().indexOf(t.toString().toLowerCase()),L=(e,t)=>null!=t&&0<=e.toString().toLowerCase().indexOf(t.toString().toLowerCase()),N=(e,t)=>null!=t&&"string"==typeof e&&e.toLowerCase().indexOf(t.toString().toLowerCase())<0;function r(r,n){if(0===n.length)return r;{var s=r;const i=[],a=[];let e=[];for(const c of n)c.type&&c.type!==u.And?(e.length&&a.push(e),e=[c]):e.push(c);a.push(e);let t=[];for(const e of a)t=t.concat(D(s,e));t=[...new Set(t)];var o=s.length;for(let e=0;e<o;e++)t.includes(e)&&i.push(s[e]);return i}}(e=u=u||{}).And="and",e.Or="or";const D=function(e,t){const r=[];if(!e)return r;for(var[n,s]of e.entries()){let e=!0;for(const a of t){var o=v(a.propertyName,s),o=f(o).value,i=f(a.value).value;const c=function(e){switch(e.toLowerCase()){case">":return y;case"<":return w;case">=":return b;case"<=":return k;case"is":case"==":return E;case"!is":case"!=":return C;case"===":return A;case"!==":return _;case"like":case"~":case"contains":return S;case"!contains":case"!like":case"!~":return N;default:return L}}(a.operator);if(!c(o,i,a.ignoreCase)){e=!1;break}}e&&r.push(n)}return r};function n(e,t){if(!t||0===t.length)return e;if(1<t.length){var s=e;var o=t;let r=[],n=[];return o.forEach(e=>{if(0===r.length)r=r.concat(h(s,e));else{for(const t of r)n=n.concat(h(t,e));r=n,n=[]}}),r}return h(e,t[0])}function h(e,t){const r=[],n=[];do{if(!e||0===e.length)break;var s=e.shift();if(!s)break;const i=s[t];var o=n.indexOf(i.toString());0<=o?r[o].push(s):(n.push(i.toString()),void 0!==r[n.length-1]?r[n.length-1].push(s):r.push([s]))}while(0<e.length);return r}function s(e,t){if(!t||0===t.length)return e;const r=Object.assign([],e);if(Array.isArray(r[0])){e=r;var n=t;const s=[];for(const o of e)s.push(o.sort(m(n)));s}else r.sort(m(t));return r}(e=g=g||{}).ascending="asc",e.descending="desc";function m(f,y=0){return function(e,u){var{propertyName:t,direction:r}=f[y];let n=e[t]||"",s=u[t]||"";const d=/^(\d{1,4}-\d{1,4}-\d{1,4}(T)?)/gim;var t=n instanceof Date&&s instanceof Date||d.test(n)&&d.test(s),h=(t&&(n=n instanceof Date?n.valueOf():new Date(Date.parse(n)),s=s instanceof Date?s.valueOf():new Date(Date.parse(s))),!isNaN(n)&&!isNaN(s)),o=(h&&(n=parseFloat(n).toPrecision(12),s=parseFloat(s).toPrecision(12)),!("true"!==n&&"false"!==n||"true"!==s&&"false"!==s));o&&(n="true"===n,s="true"===s);let i,a,c=(a=r===g.descending?(i=s,n):(i=n,s),0);if(o||t||h)c=i-a;else{i=i.toString().trim().toLowerCase(),a=a.toString().trim().toLowerCase();const l=/\d/gim;r=l.test(n)&&l.test(s);c=r?i.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"}):i.localeCompare(a)}o=y+1;if(0===c&&o<f.length){const p=m(f,o);return p(e,u)}return c}}const O=(e,t)=>{if(t){var r=e;const n={};for(const s of t){let e=r.map(e=>e[s].toString());const o=e.map(e=>p(e));o.some(e=>e===l.Float)?(e=e.map(e=>parseFloat(e)),n[s]=parseFloat(e.reduce((e,t)=>e+t).toFixed(2))):(e=e.map(e=>parseInt(e)),n[s]=e.reduce((e,t)=>e+t))}return n}return{}};class x{model;sortDetails=[];filterDetails=[];selection=[];groupByProperties=[];distinctProperties=[];concatenationToken=", ";constructor(e){this.model=JSON.parse(JSON.stringify(e))}sort(e){return this.sortDetails=e,this}orderBy(e,t){return this.sortDetails.push({propertyName:e,direction:t}),this}thenOrderBy(e,t){return this.orderBy(e,t)}filter(e){return Array.isArray(e)?this.filterDetails=e:this.filterDetails.push(e),this}where(e,t,r,n,s){return this.filterDetails.push({propertyName:e,operator:t,value:r,type:n,ignoreCase:s}),this}andWhere(e,t,r,n){return this.where(e,t,r,u.And,n),this}orWhere(e,t,r,n){return this.where(e,t,r,u.Or,n),this}group(e){return this.groupByProperties=e,this}groupBy(e){return this.groupByProperties.push(e),this}thenGroupBy(e){return this.groupByProperties.push(e),this}select(e){return Array.isArray(e)?this.selection=e:"*"!==e&&(this.selection=[e]),this}distinct(e,t){return t&&(this.concatenationToken=t),Array.isArray(e)?this.distinctProperties=e:e&&(this.distinctProperties=[e]),this}execute(){return n(function(t,r){if(0===r.length)return t;{var n=r;let e=[];for(const s of t){const o={};for(const i of n)o[i]=s[i];e.push(o)}return e}}(function(r,n,u){if(!n||!n.length)return r;const s=[],d=[];for(const f of r){const i={};let t="";for(const e of n){var h=v(e,f);i[e]=h,t+=h}if(!d.includes(t)){let e=r;for(const a of Object.keys(i))e=e.filter(e=>e[a]===i[a]);d.push(t),s.push(e)}}const t=[];for(const y of s){let e={};for(const c of y){var o,p=Object.keys(e);if(p.length)for(const l of p)n.includes(l)||(o=e[l],Array.isArray(o)?(o=c[l],Array.isArray(o)?e[l]=[...new Set(...e[l].concat(c[l]))]:e[l].includes(c[l])||e[l].push(c[l])):isNaN(e[l])&&isNaN(c[l])?e[l]!==c[l]&&(e[l]=[e[l],c[l]]):e[l]=e[l]+c[l]);else e=c}t.push(e)}return t.forEach(e=>{for(const t in e)Array.isArray(e[t])&&(e[t]=e[t].join(u))}),t}(s(r(JSON.parse(JSON.stringify(this.model)),this.filterDetails),this.sortDetails),this.distinctProperties,this.concatenationToken),this.selection),this.groupByProperties)}sum(e,t){e=Array.isArray(e)?e:[e];return O(t||this.model,e)}}class B extends HTMLElement{component=null;_contents=[];_orderBy=[];properties=new Set;_columnOrder=[];_filter="";uniqueEntriesByProperties={};propertyLabelDictionary={};static get observedAttributes(){return["contents","columns","sort","direction","filter"]}get columnOrder(){return this._columnOrder.length?this._columnOrder:this.properties}set columnOrder(e){let t;"string"==typeof e&&(t=e.split(",")),t=e,this._columnOrder=t}get contents(){return this._contents}set contents(e){this.analyzeData(e),this._contents=new x(e)}get orderBy(){return this._orderBy}set orderBy(e){this._orderBy=e}get filter(){return this._filter}set filter(e){this._filter=e.toString()}constructor(){super(),this.setContents(this.getAttribute("contents")),this.setColumnOrder(this.getAttribute("columns")),this.filter=this.getAttribute("filter")||"";var e=this.getAttribute("sort"),t=this.getAttribute("direction");e&&this._orderBy.push({propertyName:e,direction:t})}attributeChangedCallback(e,t,r){switch(e){case"contents":this.setContents(r);break;case"sort":this.orderBy=[{propertyName:r,direction:this.getAttribute("direction")}];break;case"filter":this.filter=r||"";break;case"columns":this.setColumnOrder(r);break;case"direction":this.orderBy=[{propertyName:this.getAttribute("sort"),direction:r}]}}createHtml(){const e=document.createElement("table");if(this.orderBy.length?this.contents.sort(this.orderBy):this.contents.sort([]),this.filter.length){const r=[];for(const n of this.columnOrder)r.push({propertyName:n,value:this.filter,operator:"like",type:"or",ignoreCase:!0});this.contents.filter(r)}else this.contents.filter([]);var t=this.createHead(),t=(e.append(t),this.contents.execute()),t=this.createBody(t);e.append(t),this.component=e}connectedCallback(){this.createHtml(),c.render(this)}disconnectedCallback(){c.removeEvents(this)}sortData(e){console.log(e);const t=o(e).target,r=function(e,t){let r=e.target,n="";for(;r.dataset[t]?n=r.dataset[t]:r=r.parentNode,!n;);return n}(e,"column");r&&(-1<(e=t._orderBy.findIndex(e=>e.propertyName===r))?"asc"===t._orderBy[e].direction?t._orderBy[e].direction="desc":t._orderBy.splice(e,1):t._orderBy.push({propertyName:r,direction:"asc"}),t.createHtml(),c.render(t))}setColumnOrder(e){this._columnOrder=e?Array.isArray(e)?e:e.split(","):[]}analyzeData(t){this.properties=new Set;var r=t.length;for(let e=0;e<r;e++)for(const n of Object.keys(t[e]))this.properties.add(n),this.uniqueEntriesByProperties[n]||(this.uniqueEntriesByProperties[n]=new Set),this.uniqueEntriesByProperties[n].add(t[e][n])}setContents(e){var t=e||this.contents||[];try{switch(typeof t){case"string":this.contents=JSON.parse(t)||[];case"object":Array.isArray(t)?this.contents=t:this.contents=[t]}}catch(e){console.log(e)}}convertJsonKeyToTitle(e){if("string"!=typeof e&&(e=e.toString()),this.propertyLabelDictionary[e])return this.propertyLabelDictionary[e];const t=e.replace(/([A-Z_])/g,e=>"_"===e?" ":" "+e.toLowerCase());var r=t.charAt(0).toUpperCase()+t.slice(1);return this.propertyLabelDictionary[e]=r}createRow(e){const t=document.createElement("tr");for(const r of this.columnOrder){const n=document.createElement("td");n.innerText=e[r],t.append(n)}return t}createBody(e){const t=document.createElement("tbody");for(const n of e){var r=this.createRow(n,null);t.append(r)}return t}createHead(){const e=document.createElement("thead"),t=document.createElement("tr");t.classList.add("cursor-pointer");for(const n of this.columnOrder){var r="flk-"+a();const s=document.createElement("th"),o=(s.id=r,s.dataset.column=n,document.createElement("span"));o.innerText=this.convertJsonKeyToTitle(n),s.append(o),c.addEvent("#"+r,"click",this.sortData);r=this.orderBy.find(e=>e.propertyName===n);if(r){const i=document.createElement("span");i.innerHTML="asc"===r.direction?'<svg xmlns="http://www.w3.org/2000/svg" style="position: relative; top: 3px; left: 2px;" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-narrow-wide"><path d="m3 8 4-4 4 4"/><path d="M7 4v16"/><path d="M11 12h4"/><path d="M11 16h7"/><path d="M11 20h10"/></svg>':'<svg xmlns="http://www.w3.org/2000/svg" style="position: relative; top: 3px; left: 2px;" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-wide-narrow"><path d="m3 16 4 4 4-4"/><path d="M7 20V4"/><path d="M11 4h10"/><path d="M11 8h7"/><path d="M11 12h4"/></svg>',s.append(i)}t.append(s)}return e.append(t),e}init(){this.createHtml(),c.render(this)}}customElements.define("flk-button",t),customElements.define("flk-table",B)}();